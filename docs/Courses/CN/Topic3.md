
# 网络层



## Concept

### 异构网络互连

网络互连指将两个以上的计算机网络通过一定的方法，用中继系统相互连接起来，以构成更大的网络系统。根据所在层次，中继系统可分为以下四种：


|       | 中继设备    |
| ----- | ------- |
| 物理层   | 转发器、集线器 |
| 数据链路层 | 网桥（交换机） |
| 网络层   | 路由器     |
| 网络层以上 | 网关      |

对于物理层和数据链路层的中继，从网络层的角度来看只是把一个网络扩大了，他们仍然是同一个网络，因此一般不称为网络互连。我们一般称网络互连为通过路由器进行网络连接和路由选择。

**路由选择**和**分组转发**是路由器的主要功能：

- **路由选择** 根据路由协议构造路由表，同时经常或定期地与相邻路由器交换信息，获取网络最新拓扑，动态更新维护路由表，以决定分组到达目的地节点的最优路径
- **分组转发** 根据转发表将分组从合适的端口转发出去

!!! note "路由表是根据路由选择算法得到的，而转发表是根据路由表得出的；讨论路由选择时，往往不区分二者"

### 网络层服务

网络层服务可分为**面向连接的虚电路**服务和**无连接的数据报**服务。

<font style="font-weight: 1000;font-size: 20px" color="orange">虚电路</font>

当两台计算机通信时，先建立一条在网络层上逻辑的虚电路。连接一旦建立，就固定了虚电路对应的物理路径。

!!! note "与电路交换类似，虚电路的通信过程也分为 虚电路建立、数据传输、虚电路释放 三个阶段"

每条虚电路具有一个 VCID，通信双方仅在连接建立时使用完整的目的地址作为分组首部，之后每个分组的首部只需要携带这条虚电路的 VCID 即可。虚电路上每一个节点都维护一个虚电路表，表中每项记录一个打开的虚电路信息，包括在接受链路和发送链路上的 VCID、前一节点和后一节点的标识等，它是在虚电路建立过程中确定的。

<font style="font-weight: 1000;font-size: 20px" color="orange">数据报</font>

网络在发送分组前无需先建立连接，网络不提供端到端的可靠传输服务。