
# 王道习题

## 数据链路层

- **二进制信号在信噪比为 127:1 的 4kHz 信道上传输，最大数据传输速率可达？**
	- 根据香农定理：$W\log_2(1+S / N)= 4k \log_2 128= 28k$
	- 注意题目有个前提为**二进制信号**，我们认为其 1 码元只能表示 1-bit，因此根据奈奎斯特定理：$2W\log_2 V = 2\times 4k \times \log_2 2 = 8k$
	- 因此答案实际为 8 kbps
- **下列选项中不属于数据链路层协议功能的是？**
	- A. 定义数据格式
		- 属于“封装成帧”（帧定界）
	- B. 提供节点之间的可靠传输
		- 属于“差错控制”
	- C. 控制对物理传输介质的访问
		- 由 MAC 子层完成，如 CSMA/CD 协议
	- **D. 为终端节点隐蔽物理传输的细节**
		- 这是物理层的功能
- CRC 的具体计算步骤会考吗？？？
	- 占位
- 数据链路层使用 **GBN 协议**，帧编号字段为 7，则*发送窗口*最大长度为？
	- $W_T \le 2^n - 1 = 127$
- 数据链路层使用 **SR 协议**，帧编号字段为 5，则*接收窗口*最大长度为？
	- $W_R\le W_T, \ W_R + W_T \le 2^n \Rightarrow W_R\le 2^{n-1}=16$
- **对于窗口总大小为 n 的滑动窗口，最多可以有多少帧已发送但没有确认？**
	- 注意题目说的是窗口总大小，即 $W_R+ W_T= n$，因此题目等价于求解发送窗口的最大值
	- 对于 GBN 协议，$W_R=1$，因此最多可以有 $n-1$ 帧已发送但没有确认
- **采用滑动窗口机制的相邻节点 A,B 之间，数据传输速率为 20kbps，数据帧和确认帧长度为 2000B，RTT 为 1400ms，帧序号为 3-bit 编号，要使得 A,B 之间信道利用率大于 80%，可以使用什么协议？（SR 协议默认 $W_T=W_R$）**
	- 无论对于哪种滑动窗口协议，信道利用率的计算方法都是：
		- $\frac{\text{发送窗口大小}\times \text{一个数据帧的发送时延}}{一个数据帧的发送时延 + RTT + 一个确认帧的发送时延}$
	- 其中分母可计算得到为 3000ms，则计算得到发送窗口大小要满足：
		- $800x / 3000 \gt 0.8 \Rightarrow x\gt 3$
	- Stop-Wait 协议 $W_T = 1$ 不满足要求
	- GBN 协议 $W_T\le2^3-1= 7$ 满足要求
	- SR 协议 $W_T \le 2^2 = 4$ 满足要求
- **两主机之间使用 GBN 协议，帧发送时延 64ms，RTT 500ms，为使信道利用率最高，至少采用几比特的帧序号？**
	- 为了使信道利用率达到 100%，发送窗口大小应该等于 $\frac{\text{数据帧发送时延}+RTT+\text{确认帧发送时延}}{数据帧发送时延}$
	- 计算得到 $\frac{628}{64}=9.8125$，向上取整得到 $W_T=10$，对应 4-bit 帧序号
	- 如果此类题目帧长度可变，则选取最短帧长进行计算
- **TDM 所用传输介质的性质是？**
	- <1> 介质的传输速率大于单个信号的位速率
	- <2> 介质的带宽大于结合信号的带宽
		- 这里的带宽指最高频率减去最低频率
- **CSMA/CD 协议的定义中，“争用期”指的是？**
	- **A.  信号在最远两个端点之间往返传输的时间**
		- 注意还有个*往返*
	- B. 信号从线路一段传输到另一端的时间
	- C. 从发送开始到收到应答的时间
	- D. 从发送完毕到收到应答的时间
- **为了更有效地检测冲突，可以使用的解决方案有？**
	- <1> 减少电缆介质的长度，减少争用期时间
	- <2> 增加最短帧长，增加发送帧的时间
	- 核心思想是要满足 “*发送帧的时间≥争用期的时间*”
- **与 CSMA/CD 网络相比，令牌环网络更适合的环境是？**
	- 负载轻❌；**负载重**；距离远❌；距离近❌
	- 令牌协议无论网络负载如何，都无冲突产生，这是它的突出优点
	- 另外还有优点是：利用率较公平；重负载下利用率高
- **无线局域网使用 CSMA/CA 协议，下列叙述正确的是 A**
	- **A. 接收方收到数据帧后，需要向发送方返回确认帧**
		- 因此具有超时重传
	- B. CA 表示 Collision Avoidance，因而此类网络中不会出现冲突
		- 只是降低冲突发生的概率，无法完全避免
	- C. 按照载波监听原理，发送站点在检测到信道空闲后立即发送
		- CSMA/CA 规定还必须等待 DIFS 时间才能发送
	- D. 不使用退避算法
		- 错错错
- **下列关于广播式网络的说法，错误的是？**
	- A. 共享广播信道
	- B. 不存在路由选择问题
	- C. 可以不要网络层
		- 广播式网络使用共享的广播信道进行通信，是局域网的一种通信方式；而局域网工作在数据链路层，不需要网络层，也就不存在路由选择问题
	- **D. 不需要服务接入点**
		- 数据链路层使用物理层的服务、向高层提供服务都需要服务接入点
- **一个长度为 40B 的 IP 数据报要封装成 802.1Q 帧进行传输，则此 802.1Q 帧数据载荷部分需要填充的字节数为？**
	- 以太网 MAC 帧最小帧长为 64B，对应最小数据载荷为 46B
	- 但 802.1Q 帧额外在首部中插入 4B 的 VLAN 标签，所以需要填充 $46-40-4=2B$
	- **注意:** 虽然这 4B 不改变最短以太网帧长，但是增大了最大以太网帧长，从 1518B 变为了 1522B
- **假设以太网 A 中 80% 通信量在本局域网内进行，其余 20% 在本局域网和因特网之间进行；而以太网 B 正好相反。两个局域网哪个更适合放置交换机而不使用集线器？**
	- 答案是以太网 A 更适合放置交换机
	- 当一个局域网 80% 通信量在本局域网内进行时，若使用集线器，则会增加冲突和延迟，降低整个网络的效率
	- 而若使用交换机将不同网段的通信隔离开，则可以提高网络性能
- **对于 100Mbps 以太网交换机，当输出端口无排队，以直通交换方式转发一个以太网帧时，引入的转发时延至少是？**
	- *直通交换方式*只检查帧的目的 MAC 地址来决定输出端口，因此引入的转发时延至少包括读取 6B 目的 MAC 地址所需的时间
		- $6B / 100Mbps = 0.48\mu s$
	- 而*存储转发方式*引入的转发时延至少包括读取整个帧的时间
- **下列关于交换机的叙述，正确的是？**
	- **A. 以太网交换机本质上是一个多端口网桥**
		- 😂其实是对的
	- B. 通过交换机互连的一组工作站构成一个冲突域
	- C. 交换机每个接口所连的网络构成一个独立的广播域
		- 本质上来说，广播域属于网络层的概念，因此只有网络层设备（如路由器）才能分割广播域
	- D. 以太网交换机可实现采用不同网络层协议的网络互连
		- 交换机是数据链路层设备，不能实现不同网络层协议网络互连


## 网络层

- **在一条点对点链路上，为了减少 IP 地址的浪费，子网掩码应指定为？**
	- 答案：255.255.255.252 或 /30
	- 点对点链路只需要两个主机 IP 地址、一个网络地址和一个广播地址，共四个，因此主机号只需要两位
- ![[cn_r_1.png]]
	- A. 若 H1 向 H3 发送数据，则 H2、H3、H4 都能收到 H1 发来的 ARP 请求报文 ✔
	- B. 若 H3 向 H1 发送数据，则 H3 能收到 H1 发来的 ARP 响应报文 ❌
		- H3 向 H1 发送数据，它将目的地址 192.168.3.2 和子网掩码逐位与运算得到 192.168.3.0，与自身的网络前缀不同，因此判断 H1 和自己不属于同于网络
		- 然后，H3 直接将该数据报发往默认网关 E1，因此没有发生 ARP 请求
	- C. 若 H1 向 H2 发送数据，则 H2、H3、H4 都能收到 H1 发来的 ARP 请求报文 ✔
	- D. 若 H3 向 H4 发送数据，则 H3 能收到 H4 发来的 ARP 响应报文 ✔
- **若路由器向 MTU=800B 的链路转发 1580B 的 IP 数据报，则第二个分片的总长度字段和 MF 标志位的值分别是？**
	- 片偏移以 8B 为单位，即分片的数据部分长度为 8 的整数倍，最接近 800-20 的为 776B
	- $(1580 -20) / 776 = 2.01$，因此分为 3 片
	- 第二个分片总长度字段为 796，MF 为 1
- RIP 协议中，收敛后某时刻 R3 检测到 201.1.2.0/25 网络不可达，并向 R2 通告一次新的距离向量，则 R2 更新后到达该网络的距离为？
	- ![[cn_r_2.png]]
	- R3 检测到网络不可达后根据自身内部存储的相邻路由器距离向量进行修改，此时它认为 R1 和 R2 到该网络的距离为 2，因此更新自己的距离为 3
	- R2 收到 “R3 到达该网络距离为 3” 的消息后，更新自己的距离为 min{R1 距离+1, R3 距离+1}，而 R1 距离为 2，因此只是从 2 变成 3，而不是 4
	- **答案：3**

## 传输层

- 在进行跨网络 IP 通信时，不考虑 NAT，传输层使用 UDP 封装，数据链路层采用以太网 MAC 帧封装，则下列字段一定保持不变的是？
	- I. UDP 总长度, II. UDP 检验和, III. FCS 帧检验序列, IV. IP 检验和
		- 传输过程中可能受到链路 MTU 限制，导致分片，于是 UDP 总长度发生变化，
	- 感觉有问题，TODO
- **A 和 B 建立了 TCP 连接，A 向 B 发送的第一个 SYN 报文段中 seq 为 211；释放连接时，A 向 B 发送的第四个挥手报文段的 seq 为 985，那么本次通信 A 向 B 总共发送了多少字节的数据？**
	- 三次握手和四次挥手中，虽然都没有传输数据，但是*第一个 SYN 段*和*第一个 FIN 段*都会消耗一个序号，因此总数据为 985-211-2=**772B**


## 应用层

- **单击万维网文档时，若该文档除了文本外，还有 3 个 gif 图像，则在 HTTP/1.0 中需要建立几次 TCP 连接？**
	- HTTP/1.0 采用非持续连接，每请求一个对象就要建立一次 TCP 来连接
	- 该文档有一个 html 对象和三个 gif 对象，因此总共 4 次
- **仅需 Web 服务器对 HTTP 报文进行响应，但不需要返回请求对象时，HTTP 请求报文应该使用什么方法？**
	- 答案：**HEAD**
	- 方法就是 GET POST PUT DELETE 这些

